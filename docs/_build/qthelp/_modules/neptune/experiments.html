<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>neptune.experiments</title>
    <link rel="stylesheet" href="../../_static/nonav.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <h1>Source code for neptune.experiments</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright (c) 2019, Neptune Labs Sp. z o.o.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">pandas.errors</span> <span class="k">import</span> <span class="n">EmptyDataError</span>

<span class="kn">from</span> <span class="nn">neptune.api_exceptions</span> <span class="k">import</span> <span class="n">ExperimentAlreadyFinished</span><span class="p">,</span> <span class="n">ChannelDoesNotExist</span><span class="p">,</span> <span class="n">PathInProjectNotFound</span>
<span class="kn">from</span> <span class="nn">neptune.exceptions</span> <span class="k">import</span> <span class="n">FileNotFound</span><span class="p">,</span> <span class="n">InvalidChannelValue</span><span class="p">,</span> <span class="n">NoChannelValue</span><span class="p">,</span> <span class="n">NotADirectory</span>
<span class="kn">from</span> <span class="nn">neptune.internal.channels.channels</span> <span class="k">import</span> <span class="n">ChannelValue</span><span class="p">,</span> <span class="n">ChannelType</span><span class="p">,</span> <span class="n">ChannelNamespace</span>
<span class="kn">from</span> <span class="nn">neptune.internal.channels.channels_values_sender</span> <span class="k">import</span> <span class="n">ChannelsValuesSender</span>
<span class="kn">from</span> <span class="nn">neptune.internal.execution.execution_context</span> <span class="k">import</span> <span class="n">ExecutionContext</span>
<span class="kn">from</span> <span class="nn">neptune.internal.storage.storage_utils</span> <span class="k">import</span> <span class="n">upload_to_storage</span><span class="p">,</span> <span class="n">UploadEntry</span><span class="p">,</span> <span class="n">normalize_file_name</span>
<span class="kn">from</span> <span class="nn">neptune.internal.utils.image</span> <span class="k">import</span> <span class="n">get_image_content</span>
<span class="kn">from</span> <span class="nn">neptune.utils</span> <span class="k">import</span> <span class="n">align_channels_on_x</span><span class="p">,</span> <span class="n">is_float</span><span class="p">,</span> <span class="n">is_nan_or_inf</span>

<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="c1"># pylint: disable=too-many-lines</span>
<div class="viewcode-block" id="Experiment"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment">[docs]</a><span class="k">class</span> <span class="nc">Experiment</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class for managing Neptune experiment.</span>

<span class="sd">    Each time User creates new experiment instance of this class is created.</span>
<span class="sd">    It lets you manage experiment, :meth:`~neptune.experiments.Experiment.log_metric`,</span>
<span class="sd">    :meth:`~neptune.experiments.Experiment.log_text`,</span>
<span class="sd">    :meth:`~neptune.experiments.Experiment.log_image`,</span>
<span class="sd">    :meth:`~neptune.experiments.Experiment.set_property`,</span>
<span class="sd">    and much more.</span>


<span class="sd">    Args:</span>
<span class="sd">        backend (:obj:`neptune.Backend`): A Backend object</span>
<span class="sd">        project (:obj:`neptune.Project`): The project this experiment belongs to</span>
<span class="sd">        _id (:obj:`str`): Experiment id</span>
<span class="sd">        internal_id (:obj:`str`): internal UUID</span>

<span class="sd">    Example:</span>
<span class="sd">        Assuming that `project` is an instance of :class:`~neptune.projects.Project`.</span>

<span class="sd">        .. code:: python3</span>

<span class="sd">            experiment = project.create_experiment()</span>

<span class="sd">    Warning:</span>
<span class="sd">        User should never create instances of this class manually.</span>
<span class="sd">        Always use: :meth:`~neptune.projects.Project.create_experiment`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">IMAGE_SIZE_LIMIT_MB</span> <span class="o">=</span> <span class="mi">15</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">_id</span><span class="p">,</span> <span class="n">internal_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span> <span class="o">=</span> <span class="n">backend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span> <span class="o">=</span> <span class="n">internal_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channels_values_sender</span> <span class="o">=</span> <span class="n">ChannelsValuesSender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execution_context</span> <span class="o">=</span> <span class="n">ExecutionContext</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Experiment short id</span>

<span class="sd">        | Combination of project key and unique experiment number.</span>
<span class="sd">        | Format is ``&lt;project_key&gt;-&lt;experiment_number&gt;``, for example: ``MPI-142``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`str` - experiment short id</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                exp_id = experiment.id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Experiment name</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`str` experiment name</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `project` is an instance of :class:`~neptune.projects.Project`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment = project.create_experiment(&#39;exp_name&#39;)</span>
<span class="sd">                exp_name = experiment.name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Current experiment state</span>

<span class="sd">        Possible values: `&#39;running&#39;`, `&#39;succeeded&#39;`, `&#39;failed&#39;`, `&#39;aborted&#39;`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`str` - current experiment state</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                state_str = experiment.state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span><span class="p">)</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">internal_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;numeric&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
                <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="mi">100</span>
            <span class="p">}</span>
        <span class="p">}</span>

<div class="viewcode-block" id="Experiment.get_system_properties"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_system_properties">[docs]</a>    <span class="k">def</span> <span class="nf">get_system_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve experiment properties.</span>

<span class="sd">        | Experiment properties are for example: `owner`, `created`, `name`, `hostname`.</span>
<span class="sd">        | List of experiment properties may change over time.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`dict` - dictionary mapping a property name to value.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                sys_properties = experiment.get_system_properties</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">shortId</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;created&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">timeOfCreation</span><span class="p">,</span>
            <span class="s1">&#39;finished&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">timeOfCompletion</span><span class="p">,</span>
            <span class="s1">&#39;running_time&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">runningTime</span><span class="p">,</span>
            <span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span>
            <span class="s1">&#39;storage_size&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">storageSize</span><span class="p">,</span>
            <span class="s1">&#39;channels_size&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">channelsSize</span><span class="p">,</span>
            <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">storageSize</span> <span class="o">+</span> <span class="n">experiment</span><span class="o">.</span><span class="n">channelsSize</span><span class="p">,</span>
            <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
            <span class="s1">&#39;notes&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s1">&#39;hostname&#39;</span><span class="p">:</span> <span class="n">experiment</span><span class="o">.</span><span class="n">hostname</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="Experiment.get_tags"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_tags">[docs]</a>    <span class="k">def</span> <span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get tags associated with experiment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`list` of :obj:`str` with all tags for this experiment.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment.get_tags()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span><span class="p">)</span><span class="o">.</span><span class="n">tags</span></div>

<div class="viewcode-block" id="Experiment.append_tag"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.append_tag">[docs]</a>    <span class="k">def</span> <span class="nf">append_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="o">*</span><span class="n">tags</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append tag(s) to the current experiment.</span>

<span class="sd">        Alias: :meth:`~neptune.experiments.Experiment.append_tags`.</span>
<span class="sd">        Only ``[a-zA-Z0-9]`` and ``-`` (dash) characters are allowed in tags.</span>

<span class="sd">        Args:</span>
<span class="sd">            tag (single :obj:`str` or multiple :obj:`str` or :obj:`list` of :obj:`str`):</span>
<span class="sd">                Tag(s) to add to the current experiment.</span>

<span class="sd">                    * If :obj:`str` is passed, singe tag is added.</span>
<span class="sd">                    * If multiple - comma separated - :obj:`str` are passed, all of them are added as tags.</span>
<span class="sd">                    * If :obj:`list` of :obj:`str` is passed, all elements of the :obj:`list` are added as tags.</span>

<span class="sd">        Examples:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                neptune.append_tag(&#39;new-tag&#39;)  # single tag</span>
<span class="sd">                neptune.append_tag(&#39;first-tag&#39;, &#39;second-tag&#39;, &#39;third-tag&#39;)  # few str</span>
<span class="sd">                neptune.append_tag([&#39;first-tag&#39;, &#39;second-tag&#39;, &#39;third-tag&#39;])  # list of str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">tags_list</span> <span class="o">=</span> <span class="n">tag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tags_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">tags_to_add</span><span class="o">=</span><span class="n">tags_list</span><span class="p">,</span>
                                  <span class="n">tags_to_delete</span><span class="o">=</span><span class="p">[])</span></div>

<div class="viewcode-block" id="Experiment.append_tags"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.append_tags">[docs]</a>    <span class="k">def</span> <span class="nf">append_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="o">*</span><span class="n">tags</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append tag(s) to the current experiment.</span>

<span class="sd">        Alias for: :meth:`~neptune.experiments.Experiment.append_tag`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="o">*</span><span class="n">tags</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.remove_tag"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.remove_tag">[docs]</a>    <span class="k">def</span> <span class="nf">remove_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes single tag from the experiment.</span>

<span class="sd">        Args:</span>
<span class="sd">            tag (:obj:`str`): Tag to be removed</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # assuming experiment has tags: `[&#39;tag-1&#39;, &#39;tag-2&#39;]`.</span>
<span class="sd">                experiment.remove_tag(&#39;tag-1&#39;)</span>

<span class="sd">        Note:</span>
<span class="sd">            Removing a tag that is not assigned to this experiment is silently ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">tags_to_add</span><span class="o">=</span><span class="p">[],</span>
                                  <span class="n">tags_to_delete</span><span class="o">=</span><span class="p">[</span><span class="n">tag</span><span class="p">])</span></div>

<div class="viewcode-block" id="Experiment.get_channels"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_channels">[docs]</a>    <span class="k">def</span> <span class="nf">get_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for :meth:`~neptune.experiments.Experiment.get_logs`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_logs</span><span class="p">()</span></div>

<div class="viewcode-block" id="Experiment.get_logs"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_logs">[docs]</a>    <span class="k">def</span> <span class="nf">get_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve all log names along with their last values for this experiment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`dict` - A dictionary mapping a log names to the log&#39;s last value.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                exp_logs = experiment.get_logs()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">internal_id</span><span class="p">)</span>
        <span class="n">channels_last_values_by_name</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">ch</span><span class="o">.</span><span class="n">channelName</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">channelsLastValues</span><span class="p">)</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
            <span class="n">last_value</span> <span class="o">=</span> <span class="n">channels_last_values_by_name</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ch</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">last_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">last_value</span><span class="o">.</span><span class="n">x</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">last_value</span><span class="o">.</span><span class="n">y</span>
            <span class="k">elif</span> <span class="n">ch</span><span class="o">.</span><span class="n">lastX</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">lastX</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">channels</span><span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span>
        <span class="k">return</span> <span class="n">channels</span></div>

    <span class="k">def</span> <span class="nf">_get_system_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_system_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">ch</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">)</span>

<div class="viewcode-block" id="Experiment.send_metric"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.send_metric">[docs]</a>    <span class="k">def</span> <span class="nf">send_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log metrics (numeric values) in Neptune.</span>

<span class="sd">        Alias for :meth:`~neptune.experiments.Experiment.log_metric`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.log_metric"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.log_metric">[docs]</a>    <span class="k">def</span> <span class="nf">log_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log metrics (numeric values) in Neptune</span>

<span class="sd">        | If a log with provided ``log_name`` does not exist, it is created automatically.</span>
<span class="sd">        | If log exists (determined by ``log_name``), then new value is appended to it.</span>

<span class="sd">        Args:</span>
<span class="sd">            log_name (:obj:`str`): The name of log, i.e. `mse`, `loss`, `accuracy`.</span>
<span class="sd">            x (:obj:`double`): Depending, whether ``y`` parameter is passed:</span>

<span class="sd">                * ``y`` not passed: The value of the log (data-point).</span>
<span class="sd">                * ``y`` passed: Index of log entry being appended. Must be strictly increasing.</span>

<span class="sd">            y (:obj:`double`, optional, default is ``None``): The value of the log (data-point).</span>
<span class="sd">            timestamp (:obj:`time`, optional, default is ``None``):</span>
<span class="sd">                Timestamp to be associated with log entry. Must be Unix time.</span>
<span class="sd">                If ``None`` is passed, `time.time() &lt;https://docs.python.org/3.6/library/time.html#time.time&gt;`_</span>
<span class="sd">                (Python 3.6 example) is invoked to obtain timestamp.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment` and</span>
<span class="sd">            &#39;accuracy&#39; log does not exists:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # Both calls below have the same effect</span>

<span class="sd">                # Common invocation, providing log name and value</span>
<span class="sd">                experiment.log_metric(&#39;accuracy&#39;, 0.5)</span>
<span class="sd">                experiment.log_metric(&#39;accuracy&#39;, 0.65)</span>
<span class="sd">                experiment.log_metric(&#39;accuracy&#39;, 0.8)</span>

<span class="sd">                # Providing both x and y params</span>
<span class="sd">                experiment.log_metric(&#39;accuracy&#39;, 0, 0.5)</span>
<span class="sd">                experiment.log_metric(&#39;accuracy&#39;, 1, 0.65)</span>
<span class="sd">                experiment.log_metric(&#39;accuracy&#39;, 2, 0.8)</span>

<span class="sd">        Note:</span>
<span class="sd">            For efficiency, logs are uploaded in batches via a queue.</span>
<span class="sd">            Hence, if you log a lot of data, you may experience slight delays in Neptune web application.</span>
<span class="sd">        Note:</span>
<span class="sd">            Passing either ``x`` or ``y`` coordinate as NaN or +/-inf causes this log entry to be ignored.</span>
<span class="sd">            Warning is printed to ``stdout``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_valid_x_y</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_float</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidChannelValue</span><span class="p">(</span><span class="n">expected_type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">actual_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_nan_or_inf</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;Invalid metric value: </span><span class="si">%s</span><span class="s1"> for channel </span><span class="si">%s</span><span class="s1">. &#39;</span>
                <span class="s1">&#39;Metrics with nan or +/-inf values will not be sent to server&#39;</span><span class="p">,</span>
                <span class="n">y</span><span class="p">,</span>
                <span class="n">log_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_nan_or_inf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;Invalid metric x-coordinate: </span><span class="si">%s</span><span class="s1"> for channel </span><span class="si">%s</span><span class="s1">. &#39;</span>
                <span class="s1">&#39;Metrics with nan or +/-inf x-coordinates will not be sent to server&#39;</span><span class="p">,</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">log_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ChannelValue</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">numeric_value</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="n">timestamp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channels_values_sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">log_name</span><span class="p">,</span> <span class="n">ChannelType</span><span class="o">.</span><span class="n">NUMERIC</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.send_text"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.send_text">[docs]</a>    <span class="k">def</span> <span class="nf">send_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log text data in Neptune.</span>

<span class="sd">        Alias for :meth:`~neptune.experiments.Experiment.log_text`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_text</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.log_text"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.log_text">[docs]</a>    <span class="k">def</span> <span class="nf">log_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log text data in Neptune</span>

<span class="sd">        | If a log with provided ``log_name`` does not exist, it is created automatically.</span>
<span class="sd">        | If log exists (determined by ``log_name``), then new value is appended to it.</span>

<span class="sd">        Args:</span>
<span class="sd">            log_name (:obj:`str`): The name of log, i.e. `mse`, `my_text_data`, `timing_info`.</span>
<span class="sd">            x (:obj:`double` or :obj:`str`): Depending, whether ``y`` parameter is passed:</span>

<span class="sd">                * ``y`` not passed: The value of the log (data-point). Must be ``str``.</span>
<span class="sd">                * ``y`` passed: Index of log entry being appended. Must be strictly increasing.</span>

<span class="sd">            y (:obj:`str`, optional, default is ``None``): The value of the log (data-point).</span>
<span class="sd">            timestamp (:obj:`time`, optional, default is ``None``):</span>
<span class="sd">                Timestamp to be associated with log entry. Must be Unix time.</span>
<span class="sd">                If ``None`` is passed, `time.time() &lt;https://docs.python.org/3.6/library/time.html#time.time&gt;`_</span>
<span class="sd">                (Python 3.6 example) is invoked to obtain timestamp.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # common case, where log name and data are passed</span>
<span class="sd">                neptune.log_text(&#39;my_text_data&#39;, str(data_item))</span>

<span class="sd">                # log_name, x and timestamp are passed</span>
<span class="sd">                neptune.log_text(log_name=&#39;logging_losses_as_text&#39;,</span>
<span class="sd">                                 x=str(val_loss),</span>
<span class="sd">                                 timestamp=1560430912)</span>

<span class="sd">        Note:</span>
<span class="sd">            For efficiency, logs are uploaded in batches via a queue.</span>
<span class="sd">            Hence, if you log a lot of data, you may experience slight delays in Neptune web application.</span>
<span class="sd">        Note:</span>
<span class="sd">            Passing ``x`` coordinate as NaN or +/-inf causes this log entry to be ignored.</span>
<span class="sd">            Warning is printed to ``stdout``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_valid_x_y</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_nan_or_inf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidChannelValue</span><span class="p">(</span><span class="n">expected_type</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">actual_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_nan_or_inf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;Invalid metric x-coordinate: </span><span class="si">%s</span><span class="s1"> for channel </span><span class="si">%s</span><span class="s1">. &#39;</span>
                <span class="s1">&#39;Metrics with nan or +/-inf x-coordinates will not be sent to server&#39;</span><span class="p">,</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">log_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ChannelValue</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">text_value</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="n">timestamp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channels_values_sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">log_name</span><span class="p">,</span> <span class="n">ChannelType</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.send_image"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.send_image">[docs]</a>    <span class="k">def</span> <span class="nf">send_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log image data in Neptune.</span>

<span class="sd">        Alias for :meth:`~neptune.experiments.Experiment.log_image`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_image</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.log_image"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.log_image">[docs]</a>    <span class="k">def</span> <span class="nf">log_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log image data in Neptune</span>

<span class="sd">        | If a log with provided ``log_name`` does not exist, it is created automatically.</span>
<span class="sd">        | If log exists (determined by ``log_name``), then new value is appended to it.</span>

<span class="sd">        Args:</span>
<span class="sd">            log_name (:obj:`str`): The name of log, i.e. `bboxes`, `visualisations`, `sample_images`.</span>
<span class="sd">            x (:obj:`double`): Depending, whether ``y`` parameter is passed:</span>

<span class="sd">                * ``y`` not passed: The value of the log (data-point). See ``y`` parameter.</span>
<span class="sd">                * ``y`` passed: Index of log entry being appended. Must be strictly increasing.</span>

<span class="sd">            y (multiple types supported, optional, default is ``None``):</span>

<span class="sd">                The value of the log (data-point). Can be one of the following types:</span>

<span class="sd">                * :obj:`PIL image`</span>
<span class="sd">                  `Pillow docs &lt;https://pillow.readthedocs.io/en/latest/reference/Image.html#image-module&gt;`_</span>
<span class="sd">                * :obj:`matplotlib.figure.Figure`</span>
<span class="sd">                  `Matplotlib 3.1.1 docs &lt;https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.figure.Figure.html&gt;`_</span>
<span class="sd">                * :obj:`str` - path to image file</span>
<span class="sd">                * 2-dimensional :obj:`numpy.array` - interpreted as grayscale image</span>
<span class="sd">                * 3-dimensional :obj:`numpy.array` - behavior depends on last dimension</span>

<span class="sd">                    * if last dimension is 1 - interpreted as grayscale image</span>
<span class="sd">                    * if last dimension is 3 - interpreted as RGB image</span>
<span class="sd">                    * if last dimension is 4 - interpreted as RGBA image</span>

<span class="sd">            image_name (:obj:`str`, optional, default is ``None``): Image name</span>
<span class="sd">            description (:obj:`str`, optional, default is ``None``): Image description</span>
<span class="sd">            timestamp (:obj:`time`, optional, default is ``None``):</span>
<span class="sd">                Timestamp to be associated with log entry. Must be Unix time.</span>
<span class="sd">                If ``None`` is passed, `time.time() &lt;https://docs.python.org/3.6/library/time.html#time.time&gt;`_</span>
<span class="sd">                (Python 3.6 example) is invoked to obtain timestamp.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # path to image file</span>
<span class="sd">                experiment.log_image(&#39;bbox_images&#39;, &#39;pictures/image.png&#39;)</span>
<span class="sd">                experiment.log_image(&#39;bbox_images&#39;, x=5, &#39;pictures/image.png&#39;)</span>
<span class="sd">                experiment.log_image(&#39;bbox_images&#39;, &#39;pictures/image.png&#39;, image_name=&#39;difficult_case&#39;)</span>

<span class="sd">                # PIL image</span>
<span class="sd">                img = PIL.Image.new(&#39;RGB&#39;, (60, 30), color = &#39;red&#39;)</span>
<span class="sd">                experiment.log_image(&#39;fig&#39;, img)</span>

<span class="sd">                # 2d numpy array</span>
<span class="sd">                array = numpy.random.rand(300, 200)*255</span>
<span class="sd">                experiment.log_image(&#39;fig&#39;, array)</span>

<span class="sd">                # 3d grayscale array</span>
<span class="sd">                array = numpy.random.rand(300, 200, 1)*255</span>
<span class="sd">                experiment.log_image(&#39;fig&#39;, array)</span>

<span class="sd">                # 3d RGB array</span>
<span class="sd">                array = numpy.random.rand(300, 200, 3)*255</span>
<span class="sd">                experiment.log_image(&#39;fig&#39;, array)</span>

<span class="sd">                # 3d RGBA array</span>
<span class="sd">                array = numpy.random.rand(300, 200, 4)*255</span>
<span class="sd">                experiment.log_image(&#39;fig&#39;, array)</span>

<span class="sd">                # matplotlib figure example 1</span>
<span class="sd">                from matplotlib import pyplot</span>
<span class="sd">                pyplot.plot([1, 2, 3, 4])</span>
<span class="sd">                pyplot.ylabel(&#39;some numbers&#39;)</span>
<span class="sd">                experiment.log_image(&#39;plots&#39;, plt.gcf())</span>

<span class="sd">                # matplotlib figure example 2</span>
<span class="sd">                from matplotlib import pyplot</span>
<span class="sd">                import numpy</span>

<span class="sd">                numpy.random.seed(19680801)</span>
<span class="sd">                data = numpy.random.randn(2, 100)</span>

<span class="sd">                figure, axs = pyplot.subplots(2, 2, figsize=(5, 5))</span>
<span class="sd">                axs[0, 0].hist(data[0])</span>
<span class="sd">                axs[1, 0].scatter(data[0], data[1])</span>
<span class="sd">                axs[0, 1].plot(data[0], data[1])</span>
<span class="sd">                axs[1, 1].hist2d(data[0], data[1])</span>

<span class="sd">                experiment.log_image(&#39;diagrams&#39;, figure)</span>

<span class="sd">        Note:</span>
<span class="sd">            For efficiency, logs are uploaded in batches via a queue.</span>
<span class="sd">            Hence, if you log a lot of data, you may experience slight delays in Neptune web application.</span>
<span class="sd">        Note:</span>
<span class="sd">            Passing ``x`` coordinate as NaN or +/-inf causes this log entry to be ignored.</span>
<span class="sd">            Warning is printed to ``stdout``.</span>
<span class="sd">        Warning:</span>
<span class="sd">            Only images up to 15MB are supported. Larger files will not be logged to Neptune.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_valid_x_y</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_nan_or_inf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">image_content</span> <span class="o">=</span> <span class="n">get_image_content</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMAGE_SIZE_LIMIT_MB</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Your image is larger than </span><span class="si">%d</span><span class="s1">MB. Neptune supports logging images smaller than </span><span class="si">%d</span><span class="s1">MB. &#39;</span>
                            <span class="s1">&#39;Resize or increase compression of this image&#39;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">IMAGE_SIZE_LIMIT_MB</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">IMAGE_SIZE_LIMIT_MB</span><span class="p">)</span>
            <span class="n">image_content</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">input_image</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">image_name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">image_content</span><span class="p">:</span>
            <span class="n">input_image</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">image_content</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_nan_or_inf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;Invalid metric x-coordinate: </span><span class="si">%s</span><span class="s1"> for channel </span><span class="si">%s</span><span class="s1">. &#39;</span>
                <span class="s1">&#39;Metrics with nan or +/-inf x-coordinates will not be sent to server&#39;</span><span class="p">,</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">log_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ChannelValue</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">image_value</span><span class="o">=</span><span class="n">input_image</span><span class="p">),</span> <span class="n">timestamp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channels_values_sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">log_name</span><span class="p">,</span> <span class="n">ChannelType</span><span class="o">.</span><span class="n">IMAGE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.send_artifact"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.send_artifact">[docs]</a>    <span class="k">def</span> <span class="nf">send_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save an artifact (file) in experiment storage.</span>

<span class="sd">        Alias for :meth:`~neptune.experiments.Experiment.log_artifact`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.log_artifact"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.log_artifact">[docs]</a>    <span class="k">def</span> <span class="nf">log_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save an artifact (file) in experiment storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            artifact (:obj:`str`): A path to the file in local filesystem.</span>
<span class="sd">            destination (:obj:`str`, optional, default is ``None``):</span>
<span class="sd">                A destination path.</span>
<span class="sd">                If ``None`` is passed, an artifact file name will be used.</span>

<span class="sd">        Raises:</span>
<span class="sd">            `FileNotFound`: When ``artifact`` file was not found.</span>
<span class="sd">            `StorageLimitReached`: When storage limit in the project has been reached.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # simple use</span>
<span class="sd">                experiment.log_artifact(&#39;images/wrong_prediction_1.png&#39;)</span>

<span class="sd">                # save file in other directory</span>
<span class="sd">                experiment.log_artifact(&#39;images/wrong_prediction_1.png&#39;, &#39;validation/images/wrong_prediction_1.png&#39;)</span>

<span class="sd">                # save file under different name</span>
<span class="sd">                experiment.log_artifact(&#39;images/wrong_prediction_1.png&#39;, &#39;images/my_image_1.png&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">artifact</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FileNotFound</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

        <span class="n">target_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span> <span class="k">if</span> <span class="n">destination</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">destination</span>

        <span class="n">upload_to_storage</span><span class="p">(</span><span class="n">upload_entries</span><span class="o">=</span><span class="p">[</span><span class="n">UploadEntry</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">artifact</span><span class="p">),</span> <span class="n">normalize_file_name</span><span class="p">(</span><span class="n">target_name</span><span class="p">))],</span>
                          <span class="n">upload_api_fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">upload_experiment_output</span><span class="p">,</span>
                          <span class="n">upload_tar_api_fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">extract_experiment_output</span><span class="p">,</span>
                          <span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.delete_artifacts"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.delete_artifacts">[docs]</a>    <span class="k">def</span> <span class="nf">delete_artifacts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes an artifact(s) (file/directory) from the experiment storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (:obj:`list` or :obj:`str`): Path or list of paths to remove from the experiment&#39;s output</span>

<span class="sd">        Raises:</span>
<span class="sd">            `FileNotFound`: If a path in experiment artifacts does not exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment.delete_artifacts(&#39;forest_results.pkl&#39;)</span>
<span class="sd">                experiment.delete_artifacts([&#39;forest_results.pkl&#39;, &#39;directory&#39;])</span>
<span class="sd">                experiment.delete_artifacts(&#39;&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;path argument must not be None&quot;</span><span class="p">)</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;path argument must not be None&quot;</span><span class="p">)</span>
            <span class="n">normalized_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">normalized_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;path to delete must be within project&#39;s directory&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">normalized_path</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span> <span class="ow">or</span> <span class="n">normalized_path</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">normalized_path</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot delete whole artifacts directory&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">rm_data</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">PathInProjectNotFound</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FileNotFound</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.download_artifact"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.download_artifact">[docs]</a>    <span class="k">def</span> <span class="nf">download_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download an artifact (file) from the experiment storage.</span>

<span class="sd">        Download a file indicated by ``path`` from the experiment artifacts and save it in ``destination_dir``.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (:obj:`str`): Path to the file to be downloaded.</span>
<span class="sd">            destination_dir (:obj:`str`):</span>
<span class="sd">                The directory where the file will be downloaded.</span>
<span class="sd">                If ``None`` is passed, the file will be downloaded to the current working directory.</span>

<span class="sd">        Raises:</span>
<span class="sd">            `NotADirectory`: When ``destination_dir`` is not a directory.</span>
<span class="sd">            `FileNotFound`: If a path in experiment artifacts does not exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment.download_artifact(&#39;forest_results.pkl&#39;, &#39;/home/user/files/&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">destination_dir</span><span class="p">:</span>
            <span class="n">destination_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

        <span class="n">project_storage_path</span> <span class="o">=</span> <span class="s2">&quot;/</span><span class="si">{exp_id}</span><span class="s2">/output/</span><span class="si">{file}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">exp_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="n">destination_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">NotADirectory</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_project</span><span class="p">,</span> <span class="n">project_storage_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">PathInProjectNotFound</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FileNotFound</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.download_sources"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.download_sources">[docs]</a>    <span class="k">def</span> <span class="nf">download_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">destination_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download a directory or a single file from experiment&#39;s sources as a ZIP archive.</span>

<span class="sd">        Download a subdirectory (or file) ``path`` from the experiment sources and save it in ``destination_dir``</span>
<span class="sd">        as a ZIP archive. The name of an archive will be a name of downloaded directory (or file) with &#39;.zip&#39; extension.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (:obj:`str`):</span>
<span class="sd">                Path of a directory or file in experiment sources to be downloaded.</span>
<span class="sd">                If ``None`` is passed, all source files will be downloaded.</span>

<span class="sd">            destination_dir (:obj:`str`): The directory where the archive will be downloaded.</span>
<span class="sd">                If ``None`` is passed, the archive will be downloaded to the current working directory.</span>

<span class="sd">        Raises:</span>
<span class="sd">            `NotADirectory`: When ``destination_dir`` is not a directory.</span>
<span class="sd">            `FileNotFound`: If a path in experiment sources does not exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # Download all experiment sources to current working directory</span>
<span class="sd">                experiment.download_sources()</span>

<span class="sd">                # Download a single directory</span>
<span class="sd">                experiment.download_sources(&#39;src/my-module&#39;)</span>

<span class="sd">                # Download all experiment sources to user-defined directory</span>
<span class="sd">                experiment.download_sources(destination_dir=&#39;/tmp/sources/&#39;)</span>

<span class="sd">                # Download a single directory to user-defined directory</span>
<span class="sd">                experiment.download_sources(&#39;src/my-module&#39;, &#39;sources/&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">destination_dir</span><span class="p">:</span>
            <span class="n">destination_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">NotADirectory</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

        <span class="n">download_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">prepare_source_download_reuqest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_download_from_request</span><span class="p">(</span><span class="n">download_request</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.download_artifacts"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.download_artifacts">[docs]</a>    <span class="k">def</span> <span class="nf">download_artifacts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">destination_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download a directory or a single file from experiment&#39;s artifacts as a ZIP archive.</span>

<span class="sd">        Download a subdirectory (or file) ``path`` from the experiment artifacts and save it in ``destination_dir``</span>
<span class="sd">        as a ZIP archive. The name of an archive will be a name of downloaded directory (or file) with &#39;.zip&#39; extension.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (:obj:`str`):</span>
<span class="sd">                Path of a directory or file in experiment artifacts to be downloaded.</span>
<span class="sd">                If ``None`` is passed, all artifacts will be downloaded.</span>

<span class="sd">            destination_dir (:obj:`str`): The directory where the archive will be downloaded.</span>
<span class="sd">                If ``None`` is passed, the archive will be downloaded to the current working directory.</span>

<span class="sd">        Raises:</span>
<span class="sd">            `NotADirectory`: When ``destination_dir`` is not a directory.</span>
<span class="sd">            `FileNotFound`: If a path in experiment artifacts does not exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # Download all experiment artifacts to current working directory</span>
<span class="sd">                experiment.download_artifacts()</span>

<span class="sd">                # Download a single directory</span>
<span class="sd">                experiment.download_artifacts(&#39;data/images&#39;)</span>

<span class="sd">                # Download all experiment artifacts to user-defined directory</span>
<span class="sd">                experiment.download_artifacts(destination_dir=&#39;/tmp/artifacts/&#39;)</span>

<span class="sd">                # Download a single directory to user-defined directory</span>
<span class="sd">                experiment.download_artifacts(&#39;data/images&#39;, &#39;artifacts/&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">destination_dir</span><span class="p">:</span>
            <span class="n">destination_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">NotADirectory</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

        <span class="n">download_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">prepare_output_download_reuqest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_download_from_request</span><span class="p">(</span><span class="n">download_request</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_download_from_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">download_request</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">sleep_time</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">max_sleep_time</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">download_request</span><span class="p">,</span> <span class="s2">&quot;downloadUrl&quot;</span><span class="p">):</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
            <span class="n">sleep_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sleep_time</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_sleep_time</span><span class="p">)</span>
            <span class="n">download_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_download_request</span><span class="p">(</span><span class="n">download_request</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># We do not use Backend here cause `downloadUrl` can be any url (not only Neptune API endpoint)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">download_request</span><span class="o">.</span><span class="n">downloadUrl</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/zip&quot;</span><span class="p">},</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="n">response</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="s1">&#39;content-disposition&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
                <span class="n">content_disposition</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;content-disposition&#39;</span><span class="p">]</span>
                <span class="n">filenames</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;filename=(.+)&quot;</span><span class="p">,</span> <span class="n">content_disposition</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">filenames</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span>

            <span class="n">destination_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">destination_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

<div class="viewcode-block" id="Experiment.reset_log"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.reset_log">[docs]</a>    <span class="k">def</span> <span class="nf">reset_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets the log.</span>

<span class="sd">        Removes all data from the log and enables it to be reused from scratch.</span>

<span class="sd">        Args:</span>
<span class="sd">            log_name (:obj:`str`): The name of log to reset.</span>

<span class="sd">        Raises:</span>
<span class="sd">            `ChannelDoesNotExist`: When the log with name ``log_name`` does not exist on the server.</span>

<span class="sd">        Example:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment.reset_log(&#39;my_metric&#39;)</span>

<span class="sd">        Note:</span>
<span class="sd">            Check Neptune web application to see that reset charts have no data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_channel</span><span class="p">(</span><span class="n">log_name</span><span class="p">,</span> <span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">USER</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ChannelDoesNotExist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">log_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">reset_channel</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.get_parameters"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve parameters for this experiment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`dict` - dictionary mapping a parameter name to value.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                exp_params = experiment.get_parameters()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">internal_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_parameter_value</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">parameterType</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.get_properties"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_properties">[docs]</a>    <span class="k">def</span> <span class="nf">get_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve User-defined properties for this experiment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`dict` - dictionary mapping a property key to value.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`.</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                exp_properties = experiment.get_properties()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">internal_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.set_property"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.set_property">[docs]</a>    <span class="k">def</span> <span class="nf">set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set `key-value` pair as an experiment property.</span>

<span class="sd">        If property with given ``key`` does not exist, it adds a new one.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (:obj:`str`): Property key.</span>
<span class="sd">            value (:obj:`obj`): New value of a property.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment.set_property(&#39;model&#39;, &#39;LightGBM&#39;)</span>
<span class="sd">                experiment.set_property(&#39;magic-number&#39;, 7)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">key</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">internal_id</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">}</span>
        <span class="n">properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">update_experiment</span><span class="p">(</span>
            <span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="n">properties</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.remove_property"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.remove_property">[docs]</a>    <span class="k">def</span> <span class="nf">remove_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes a property with given key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (single :obj:`str`):</span>
<span class="sd">                Key of property to remove.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                experiment.remove_property(&#39;host&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">key</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">internal_id</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">}</span>
        <span class="k">del</span> <span class="n">properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">update_experiment</span><span class="p">(</span>
            <span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="n">properties</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Experiment.get_hardware_utilization"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_hardware_utilization">[docs]</a>    <span class="k">def</span> <span class="nf">get_hardware_utilization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve GPU, CPU and memory utilization data.</span>

<span class="sd">        Get hardware utilization metrics for entire experiment as a single</span>
<span class="sd">        `pandas.DataFrame &lt;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html&gt;`_</span>
<span class="sd">        object. Returned DataFrame has following columns (assuming single GPU with 0 index):</span>

<span class="sd">            * `x_ram` - time (in milliseconds) from the experiment start,</span>
<span class="sd">            * `y_ram` - memory usage in GB,</span>
<span class="sd">            * `x_cpu` - time (in milliseconds) from the experiment start,</span>
<span class="sd">            * `y_cpu` - CPU utilization percentage (0-100),</span>
<span class="sd">            * `x_gpu_util_0` - time (in milliseconds) from the experiment start,</span>
<span class="sd">            * `y_gpu_util_0` - GPU utilization percentage (0-100),</span>
<span class="sd">            * `x_gpu_mem_0` - time (in milliseconds) from the experiment start,</span>
<span class="sd">            * `y_gpu_mem_0` - GPU memory usage in GB.</span>

<span class="sd">        | If more GPUs are available they have their separate columns with appropriate indices (0, 1, 2, ...),</span>
<span class="sd">          for example: `x_gpu_util_1`, `y_gpu_util_1`.</span>
<span class="sd">        | The returned DataFrame may contain ``NaN`` s if one of the metrics has more values than others.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`pandas.DataFrame` - DataFrame containing the hardware utilization metrics.</span>

<span class="sd">        Examples:</span>
<span class="sd">            The following values denote that after 3 seconds, the experiment used 16.7 GB of RAM</span>

<span class="sd">                * `x_ram` = 3000</span>
<span class="sd">                * `y_ram` = 16.7</span>

<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                hardware_df = experiment.get_hardware_utilization()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metrics_csv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_metrics_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">metrics_csv</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">EmptyDataError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="Experiment.get_numeric_channels_values"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.get_numeric_channels_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_numeric_channels_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">channel_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve values of specified metrics (numeric logs).</span>

<span class="sd">        The returned</span>
<span class="sd">        `pandas.DataFrame &lt;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html&gt;`_</span>
<span class="sd">        contains 1 additional column `x` along with the requested metrics.</span>

<span class="sd">        Args:</span>
<span class="sd">            *channel_names (one or more :obj:`str`): comma-separated metric names.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`pandas.DataFrame` - DataFrame containing values for the requested metrics.</span>

<span class="sd">            | The returned DataFrame may contain ``NaN`` s if one of the metrics has more values than others.</span>

<span class="sd">        Example:</span>
<span class="sd">            Invoking ``get_numeric_channels_values(&#39;loss&#39;, &#39;auc&#39;)`` returns DataFrame with columns</span>
<span class="sd">            `x`, `loss`, `auc`.</span>

<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                batch_channels = experiment.get_numeric_channels_values(&#39;batch-1-loss&#39;, &#39;batch-2-metric&#39;)</span>
<span class="sd">                epoch_channels = experiment.get_numeric_channels_values(&#39;epoch-1-loss&#39;, &#39;epoch-2-metric&#39;)</span>

<span class="sd">        Note:</span>
<span class="sd">            It&#39;s good idea to get metrics with common temporal pattern (like iteration or batch/epoch number).</span>
<span class="sd">            Thanks to this each row of returned DataFrame has metrics from the same moment in experiment.</span>
<span class="sd">            For example, combine epoch metrics to one DataFrame and batch metrics to the other.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">channels_by_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_channels</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channel_names</span><span class="p">:</span>
            <span class="n">channel_id</span> <span class="o">=</span> <span class="n">channels_by_name</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">channels_data</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">get_channel_points_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">),</span>
                    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_name</span><span class="p">),</span> <span class="s1">&#39;y_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)],</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">EmptyDataError</span><span class="p">:</span>
                <span class="n">channels_data</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_name</span><span class="p">),</span> <span class="s1">&#39;y_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)],</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">align_channels_on_x</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">channels_data</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">upload_source_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">abort_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">upload_stdout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">upload_stderr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">send_hardware_metrics</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">run_monitoring_thread</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">handle_uncaught_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">upload_to_storage</span><span class="p">(</span><span class="n">upload_entries</span><span class="o">=</span><span class="n">upload_source_entries</span><span class="p">,</span>
                          <span class="n">upload_api_fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">upload_experiment_source</span><span class="p">,</span>
                          <span class="n">upload_tar_api_fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">extract_experiment_source</span><span class="p">,</span>
                          <span class="n">experiment</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execution_context</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
            <span class="n">abort_callback</span><span class="o">=</span><span class="n">abort_callback</span><span class="p">,</span>
            <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
            <span class="n">upload_stdout</span><span class="o">=</span><span class="n">upload_stdout</span><span class="p">,</span>
            <span class="n">upload_stderr</span><span class="o">=</span><span class="n">upload_stderr</span><span class="p">,</span>
            <span class="n">send_hardware_metrics</span><span class="o">=</span><span class="n">send_hardware_metrics</span><span class="p">,</span>
            <span class="n">run_monitoring_thread</span><span class="o">=</span><span class="n">run_monitoring_thread</span><span class="p">,</span>
            <span class="n">handle_uncaught_exceptions</span><span class="o">=</span><span class="n">handle_uncaught_exceptions</span>
        <span class="p">)</span>

<div class="viewcode-block" id="Experiment.stop"><a class="viewcode-back" href="../../neptune-client/docs/experiment.html#neptune.experiments.Experiment.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_tb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Marks experiment as finished (succeeded or failed).</span>

<span class="sd">        Args:</span>
<span class="sd">            exc_tb (:obj:`str`, optional, default is ``None``): Additional traceback information</span>
<span class="sd">                to be stored in experiment details in case of failure (stacktrace, etc).</span>
<span class="sd">                If this argument is ``None`` the experiment will be marked as succeeded.</span>
<span class="sd">                Otherwise, experiment will be marked as failed.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming that `experiment` is an instance of :class:`~neptune.experiments.Experiment`:</span>

<span class="sd">            .. code:: python3</span>

<span class="sd">                # Marks experiment as succeeded</span>
<span class="sd">                experiment.stop()</span>

<span class="sd">                # Assuming &#39;ex&#39; is some exception,</span>
<span class="sd">                # it marks experiment as failed with exception info in experiment details.</span>
<span class="sd">                experiment.stop(str(ex))</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_channels_values_sender</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">exc_tb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">mark_succeeded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">mark_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ExperimentAlreadyFinished</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execution_context</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="c1"># pylint: disable=protected-access</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_project</span><span class="o">.</span><span class="n">_remove_stopped_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">exc_tb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_tb</span><span class="p">(</span><span class="n">exc_tb</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">exc_val</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Experiment(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="c1"># pylint: disable=protected-access</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">==</span> <span class="n">o</span><span class="o">.</span><span class="n">_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_id</span> <span class="o">==</span> <span class="n">o</span><span class="o">.</span><span class="n">_internal_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="o">==</span> <span class="n">o</span><span class="o">.</span><span class="n">_project</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_convert_parameter_value</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parameter_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">parameter_type</span> <span class="o">==</span> <span class="s1">&#39;double&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_valid_x_y</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The goal of this function is to allow user to call experiment.log_* with any of:</span>
<span class="sd">            - single parameter treated as y value</span>
<span class="sd">            - both parameters (named/unnamed)</span>
<span class="sd">            - single named y parameter</span>
<span class="sd">        If intended X-coordinate is provided, it is validated to be a float value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoChannelValue</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">x</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">InvalidChannelValue</span><span class="p">(</span><span class="n">expected_type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">actual_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">_send_channels_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_with_values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">send_channels_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_with_values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_names_with_types</span><span class="p">):</span>
        <span class="n">existing_channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_channels</span><span class="p">()</span>
        <span class="n">channels_by_name</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">)</span> <span class="ow">in</span> <span class="n">channels_names_with_types</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">existing_channels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_channel</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">)</span>
            <span class="n">channels_by_name</span><span class="p">[</span><span class="n">channel</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel</span>
        <span class="k">return</span> <span class="n">channels_by_name</span>

    <span class="k">def</span> <span class="nf">_get_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">,</span> <span class="n">channel_namespace</span><span class="o">=</span><span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">USER</span><span class="p">):</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_channel</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_namespace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_channel</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">,</span> <span class="n">channel_namespace</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">channel</span>

    <span class="k">def</span> <span class="nf">_find_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_namespace</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">channel_namespace</span> <span class="o">==</span> <span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_channels</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">channel_namespace</span> <span class="o">==</span> <span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">SYSTEM</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_system_channels</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown channel namespace </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_namespace</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_create_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">,</span> <span class="n">channel_namespace</span><span class="o">=</span><span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">USER</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">channel_namespace</span> <span class="o">==</span> <span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">channel_namespace</span> <span class="o">==</span> <span class="n">ChannelNamespace</span><span class="o">.</span><span class="n">SYSTEM</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">create_system_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown channel namespace </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_namespace</span><span class="p">))</span></div>
</pre></div>

          </div>
      </div>
      <div class="clearer"></div>
    </div>


  <script src="/docker-config.js"></script>
  <script>
    /* !
     * JavaScript Cookie v2.2.1
     * https://github.com/js-cookie/js-cookie
     *
     * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
     * Released under the MIT license
     *
     * Minified by jsDelivr using Terser v3.14.1.
     * Original file: /npm/js-cookie@2.2.1/src/js.cookie.js
     *
     * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
     */
    !function(e){var n;if("function"==typeof define&&define.amd&&(define(e),n=!0),"object"==typeof exports&&(module.exports=e(),n=!0),!n){var t=window.Cookies,o=window.Cookies=e();o.noConflict=function(){return window.Cookies=t,o}}}(function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var o in t)n[o]=t[o]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function t(o){function r(){}function i(n,t,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var c=JSON.stringify(t);/^[\{\[]/.test(c)&&(t=c)}catch(e){}t=o.write?o.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var f="";for(var u in i)i[u]&&(f+="; "+u,!0!==i[u]&&(f+="="+i[u].split(";")[0]));return document.cookie=n+"="+t+f}}function c(e,t){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],c=0;c<i.length;c++){var f=i[c].split("="),u=f.slice(1).join("=");t||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var a=n(f[0]);if(u=(o.read||o)(u,a)||n(u),t)try{u=JSON.parse(u)}catch(e){}if(r[a]=u,e===a)break}catch(e){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return c(e,!1)},r.getJSON=function(e){return c(e,!0)},r.remove=function(n,t){i(n,"",e(t,{expires:-1}))},r.defaults={},r.withConverter=t,r}(function(){})});
  </script>

  <script>
    function initGA(isProduction) {
      if (!isProduction) {
        // eslint-disable-next-line no-console
        console.warn('GA will not load in development mode');
        return;
      }

      /* eslint-disable */
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-102823704-1', 'auto');
      ga('send', 'pageview');
      /* eslint-enable */
    }

    initGA(window.dockerConfig.isProduction);
  </script>

  <script>
    /* global heap, hj */

    var options = {
      devel: {
        appId: 569758,
      },
      prod: {
        appId: 569747,
      },
    };

    function initHotJar(isProduction) {
      var appId = getAppId(isProduction);

      appendHotJarScript(appId);
      tagRecording();
    }

    function appendHotJarScript(appId) {
      (function (h, o, t, j, a, r) {
        h.hj = h.hj || function () {
          (h.hj.q = h.hj.q || []).push(arguments);
        };
        h._hjSettings = {hjid: appId, hjsv: 5};
        a = o.getElementsByTagName('head')[0];
        r = o.createElement('script');
        r.async = 1;
        r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
        a.appendChild(r);
      })(window, document, '//static.hotjar.com/c/hotjar-', '.js?sv=');
    }

    function getAppId(isProduction) {
      return isProduction ? options.prod.appId : options.devel.appId;
    }

    function tagRecording() {
      var TAG_RECORDING_DELAY = 5 * 1000;

      if (canSafelyTagRecording()) {
        hj('tagRecording', [ heap.identity ]);
      } else {

        // try until all needed libs and data is available
        window.setTimeout(tagRecording, TAG_RECORDING_DELAY);
      }
    }

    function canSafelyTagRecording() {
      return (
        typeof hj === 'function'
        && typeof heap === 'object'
        && typeof heap.identity === 'string'
        && heap.identity.length > 0
      );
    }

    initHotJar(window.dockerConfig.isProduction);
  </script>

  <script>
    function initIntercom(isProduction) {
      var options = {
        devel: {
          appId: 'wqilukic',
        },
        prod: {
          appId: 'yoy39he9',
        },
      };

      var username = window.Cookies.get('neptune-uid');

      window.intercomSettings = {
        app_id: getAppId(isProduction),
      };

      var isUsernamePreserved = typeof username === 'string' && username.length > 0;
      if (isUsernamePreserved) {
        window.intercomSettings.user_id = username;
      }

      function getAppId(isProduction) {
        return isProduction ? options.prod.appId : options.devel.appId;
      }


      // Intercom official integration code
      // eslint-disable-next-line
      (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/wqilukic';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
      // Intercom official integration code
    }

    initIntercom(window.dockerConfig.isProduction);
  </script>


  </body>
</html>